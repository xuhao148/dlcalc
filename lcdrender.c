#include "dlcalc.h"#include <string.h>extern DLCalc *gCalc;extern char gLCDBits[30][30];void tRenderLCD() {	static const char tiles[][8] = {{0x00,0x00,0x0F,0x18,0x1B,0x1B,0x0F,0x00}, // 'G'									{0x00,0x00,0x7E,0x18,0x18,0x18,0x18,0x00}, // 'T'									{0x00,0x00,0x0D,0x1A,0x1A,0x1A,0x1A,0x00}, // 'M' left									{0x00,0x00,0x80,0xC0,0xC0,0xC0,0xC0,0x00}, // 'M' right									{0x00,0x3F,0x30,0x3C,0x30,0x30,0x3F,0x00}, // 'E' left									{0x00,0x80,0x00,0x00,0x00,0x00,0x80,0x00}, // 'E' right									{0x00,0x00,0x00,0x00,0x00,0x1F,0x1F,0x00}, // '-' left									{0x00,0x00,0x00,0x00,0x00,0xE0,0xE0,0x00}, // '-' right									{0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0x7E}, // Seg. 0									{0x02,0x03,0x03,0x03,0x03,0x03,0x02,0x00}, // Seg. 1									{0x40,0xC0,0xC0,0xC0,0xC0,0xC0,0x40,0x00}, // Seg. 2									{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF}, // Seg. 3 (upper)									{0x00,0x02,0x03,0x03,0x03,0x03,0x03,0x02}, // Seg. 4									{0x00,0x40,0xC0,0xC0,0xC0,0xC0,0xC0,0x40}, // Seg. 5									{0x00,0x7E,0xFF,0x00,0x00,0x00,0x00,0x00}, // Seg. 6									{0x00,0x18,0x18,0x00,0x00,0x00,0x00,0x00}, // Seg. 7 (Dot)									{0x00,0x00,0x30,0x30,0x30,0x20,0x00,0x00}, // Apos.									{0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, // Seg. 3 (lower)									};	static const int offset_x[] = {1,0,2,1,0,2,1,2};	static const int offset_y[] = {0,1,1,1,2,2,3,3};	int i,j,k;		memset(gLCDBits,0,900);		// GT	if (gCalc->lcd.specials & DL_GT) {		for (i=0; i<8; i++) {			gLCDBits[i][0] |= tiles[0][i];			gLCDBits[i][1] |= tiles[1][i];		}	}		// M	if (gCalc->lcd.specials & DL_M) {		for (i=0; i<8; i++) {			gLCDBits[9+i][0] |= tiles[2][i];			gLCDBits[9+i][1] |= tiles[3][i];		}	}		// E	if (gCalc->lcd.specials & DL_E) {		for (i=0; i<8; i++) {			gLCDBits[19+i][0] |= tiles[4][i];			gLCDBits[19+i][1] |= tiles[5][i];		}	}		// -	if (gCalc->lcd.specials & DL_MINUS) {		for (i=0; i<8; i++) {			gLCDBits[9+i][2] |= tiles[6][i];			gLCDBits[9+i][3] |= tiles[7][i];		}	}		// Digits	for (i=0; i<12; i++) {		int base_grid = 4 + 2 * i;		unsigned char digit = gCalc->lcd.digits[11-i];		// Seg. 0 - 7		for (j = 0; j < 8; j++) {		if (digit & (1 << j)) {			for (k=0; k<8; k++) {				gLCDBits[offset_y[j]*8+k][base_grid+offset_x[j]] |= tiles[8+j][k];				if (j == 3) {					gLCDBits[16][base_grid+1] |= tiles[17][k];				}			}		}		if (gCalc->lcd.commas & (1<<(11-i))) {			for (k=0; k<8; k++)				gLCDBits[k][base_grid+2] |= tiles[16][k];		}		}	}}